<!-- Messages Modal -->
<!-- Modal -->
<div
	class="modal fade"
	id="messagesModal"
	tabindex="-1"
	role="dialog"
	aria-labelledby="modalTitleId"
	aria-hidden="true"
>
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="modalTitleId">
					<span
						data-uk-icon="icon: comments"
						class="uk-margin-small-right"
					></span
					>Messages
				</h5>
				<button
					type="button"
					class="btn-close"
					data-bs-dismiss="modal"
					aria-label="Close"
				></button>
			</div>
			<div class="modal-body">
				<div class="container-fluid">
					<% user.messages.forEach(message=>{ %>
					<div class="nature-card">
						<div class="uk-card uk-card-small uk-card-default">
							<div class="uk-card-header">
								<div class="uk-grid uk-grid-small uk-text-small" data-uk-grid>
									<div
										class="uk-width-expand"
										title="Unit Code"
										data-uk-tooltip
									>
										<span class="cat-txt"> Alert</span>
									</div>

									<div
										class="uk-width-auto uk-text-right uk-text-muted"
										title="Members"
										data-uk-tooltip
									>
										<% if (!message.read) { %>
										<span class="uk-text-success"> ðŸ”´ </span>
										New <% }else{ %>

										<span class="uk-text-success"> ðŸŸ¢ </span>
										Read <% } %>
									</div>
								</div>
							</div>
							<div class="uk-card-media"></div>

							<div class="uk-card-body">
								<% let thdate %>
								<h6
									class="uk-margin-small-bottom uk-margin-remove-adjacent uk-text-bold"
								>
									<%= message.title %>
								</h6>
								<% thdate = new Date(message.createdAt).toLocaleTimeString() %>

								<p class="uk-text-small uk-text-muted">
									<%= formatDate(message.createdAt) %> at <%= thdate %>
								</p>
							</div>
							<!-- <div class="uk-card-footer">
										<div
											class="uk-grid uk-grid-small uk-grid-divider uk-flex uk-flex-middle"
											data-uk-grid
										>
											<div
												class="uk-width-expand uk-text-small"
												title="Lecturer"
												data-uk-tooltip
											>
												Lec:
											</div>
										</div>
									</div> -->
						</div>
					</div>

					<% }) %>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
					Close
				</button>
				<% if (newMessages > 0) { %>
				<form
					action="/<%= theUserType %>/messages/markasread/<%= user._id %>"
					method="post"
				>
					<button type="submit" class="btn btn-primary">
						Mark All As Read
						<i data-uk-icon="icon: check"></i>
					</button>
				</form>

				<% }else{ %>
				<button type="submit" class="btn btn-info disabled">
					No New Messages
					<i data-uk-icon="icon: check"></i>
				</button>
				<% } %> <% if (user.messages.length > 0) { %>
				<form
					action="/<%= theUserType %>/messages/delete/<%= user._id %>"
					method="post"
				>
					<button type="submit" class="btn btn-primary">
						Delete All
						<i data-uk-icon="icon: trash"></i>
					</button>
				</form>

				<% } %>
			</div>
		</div>
	</div>
</div>

<script>
	var messagesModal = document.getElementById("messagesModal");

	messagesModal.addEventListener("show.bs.modal", function (event) {
		// Button that triggered the modal
		let button = event.relatedTarget;
		// Extract info from data-bs-* attributes
		let recipient = button.getAttribute("data-bs-whatever");

		// Use above variables to manipulate the DOM
	});
</script>
